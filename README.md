# Решение команды MISIS Leaf Lovers для хакатона "Привет, Спутник!" от компании СОНИКС и Геоскан

## Описание проекта
Это веб-приложение, разработанное для хакатона *"Привет, Спутник!"* от компании *СОНИКС*. Решаемый кейс — автоматизация отслеживания работы наземной станции в режиме реального времени. Приложение предоставляет удобный интерфейс для работы с картами, архивами данных, уведомлениями и другими функциями.

## Основные термины
Чтобы понять, как работает проект, надо понять основные термины, которые используются в этом README.

**SDR**
Программно определяемая радиосистема - это радиосистема, в которой традиционно аппаратные компоненты (например, модулятор, демодулятор, фильтры, микшеры и т.д.) реализуются программно, а не с помощью специализированной электроники.

**WebSDR**
Система программно-определяемой радиосвязи (SDR), доступная через веб-интерфейс, позволяющая принимать и обрабатывать сигналы в реальном времени.

**GNURadio**
Инструментарий с открытым исходным кодом для создания программно-определяемых радиосистем, используемых для обработки и анализа радиосигналов. GNURadio Pipeline - программа из блоков GNURadio (или может быть представлена кодом, то есть каждый блок - код).

**Osmocom Source**
Блок GNURadio который берет данные с SDR и передает их дальше в pipeline.

**Сеть СОНИКС**
Сеть спутниковой связи для управления наземными станциями и отслеживания спутников.

**Наземная станция**
Наземное сооружение, оборудованное для связи со спутниками, включая прием и передачу сигналов.

**WebSocket**
Протокол связи, обеспечивающий двунаправленный обмен данными в реальном времени между клиентом и сервером.

**Обработка сигналов**
Анализ, интерпретация и обработка сигналов, полученных со спутников.

**Планировщик наблюдений**
Инструмент для планирования и управления сеансами спутниковых наблюдений.

## Техническое описание
Проект состоит из 2 главных частей: серверная часть и клиентская часть. Серверная часть должна включаться напрямую на портал [sonik.space](sonik.space), а клиентская часть включается в [клиент соникса](https://gitlab.com/space-education-development/soniks/soniks-client). Рассмотрим как работает каждая из них:

### Серверная часть

Серверная часть приложения создана с использованием **Flask**, облегченного веб-фреймворка Python, и интегрируется с базой данных **PostgreSQL** через **SQLAlchemy** для управления данными. Ниже приведен обзор того, как работают компоненты на стороне сервера:

---

#### 1. **Инициализация и настройка базы данных**
- Файл bdinit.py содержит функции для инициализации схемы базы данных и заполнения ее базовыми данными:
- `init_bd()`: создает все таблицы базы данных, определенные в файле dbmanager.py.
- `populate_base_data()`: добавляет образцы пользователей, станций и записей о владельце в базу данных для целей тестирования.

---

#### 2. **Управление базой данных**
- Файл dbmanager.py определяет схему базы данных и предоставляет служебные функции для взаимодействия с базой данных:
- **Модели**:
- `User`: представляет пользователей системы, хранит учетные данные, ключи API и контактную информацию.
- `Station`: представляет наземные станции спутниковой связи, включая местоположение, настройки уведомлений и адреса серверов SDR.
- `Ownership`: связывает пользователей со станциями, которыми они владеют.
- **Служебные функции**:
- `update_station_info()`: обновляет данные о станции, такие как имя, местоположение и настройки уведомлений.
- `get_station_owner()`: извлекает владельца определенной станции.
- `get_stations_by_user_id()`: извлекает все станции, принадлежащие пользователю.
- `confirm_ownership()`: подтверждает, является ли пользователь владельцем определенной станции.
- `register_sdr_bd()`: регистрирует адрес сервера SDR для станции.

---

#### 3. **Веб-приложение**
- Файл main.py определяет приложение Flask и его маршруты. Маршруты специально подобраны для удобства интеграции с платформой соникс:
- **Аутентификация**:
- `/login`: обрабатывает вход пользователя с использованием учетных данных, хранящихся в базе данных.
- `/logout`: выходит из системы текущего пользователя.
- **Управление пользователями и станциями**:
- `/users/<name>`: отображает все станции, принадлежащие пользователю.
- `/stations/<id>`: отображает подробную информацию о конкретной станции.
- `/stations/<id>/edit`: позволяет пользователям редактировать сведения о станции.
- **Панель управления станцией**:
- `/stations/<id>/dashboard`: отображает панель управления для конкретной станции, включая карты и спутниковое отслеживание.
- `/stations/<id>/dashboard/map`: Создает карту с треками спутников и зонами покрытия.
- `/stations/<id>/dashboard/reception`: Перенаправляет на сервер SDR для приема сигнала.
- `/stations/<id>/dashboard/archive`: Отображает архивные данные для станции.
- `/stations/<id>/dashboard/settings`: Позволяет пользователям настраивать параметры уведомлений и ключи API.
- **Регистрация SDR**:
- `/stations/<id>/register_sdr`: Регистрирует сервер SDR для станции с помощью ключа API.

---

#### 4. **Спутниковое отслеживание и визуализация**
- Файл map.py предоставляет функциональные возможности для спутникового отслеживания и визуализации:
- `get_satellite_tracks_from_tle(tle_str)`: обрабатывает строку TLE (двухстрочный элемент) для расчета спутниковых треков и текущих положений.
- Маршрут `/stations/<id>/dashboard/map` использует эту функцию для создания:
- **визуализации карты**, показывающей спутниковые треки и зоны покрытия станции.
- **полярного графика**, показывающего видимость спутника со станции.

---

Эта серверная архитектура обеспечивает эффективное управление учетными записями пользователей, наземными станциями и данными спутникового слежения, предоставляя при этом удобный интерфейс для мониторинга и управления наземными станциями.

### Клиентская часть


## Потенциал развития проекта
То, что мы хотели бы добавить, чтобы дополнить проект:
- 3D Карта для лучшей визуализации
- Использовать технологию расширения LAN по типу *ZeroTier* или *Hamachi* для удобства настройки P2P коммуникации между серверами
- Контейнеризровать решение с помощью *Docker* чтобы развернуть наше решение на всех платформах и операционных системах

## Стек технологий
Проект разработан с использованием следующих технологий:

### Backend:
- **Python** (Flask) — для обработки запросов и управления серверной логикой.
- **Matplotlib**: создает визуализации для спутниковых треков и зон покрытия.
- **Beyond.io**: обрабатывает данные TLE для спутникового отслеживания.
- **PostgreSQL**: хранит данные о пользователях, станциях и владельцах.
- **SQLAlchemy** — для хранения данных (выберите вашу базу данных).

### Frontend:
- **HTML** и **CSS** — для создания пользовательского интерфейса.
- **JavaScript** — для динамического взаимодействия с пользователем.
- **Bootstrap5** — для адаптивного дизайна.

### Прочее:
- **Jinja2** — для шаблонизации HTML.

---

## Установка и запуск проекта (Серверная часть)

### 1. Клонирование репозитория
Склонируйте проект на ваш локальный компьютер:
```bash
git clone https://github.com/BUSH222/soniks-hack
cd soniks-hack
```

### 2. Установка зависимостей
Убедитесь, что у вас установлен Python (рекомендуется версия 3.8 или выше). Установите виртуальное окружение и зависимости:
```bash
#Windows
pip install -r requirements.txt
```

### 3. Можно запускать проект!

## Основные функции
Карта: Визуализация станций на карте.
Прием сигналов: Управление сигналами и их обработка.
Архив и аналитика: Просмотр и анализ исторических данных.
Планировщик: Планирование наблюдений.
Настройки: Управление уведомлениями, API-ключами и другими параметрами.

Для запуска клиентской части требуется SDR и установка GNURadio и gr-osmocom. Затем, следуете инструкциям установки серверной части, но склонируйте ветку dev-client. Мы тестировали проект используя RTL-SDR Blog v3. 

### Выполнено командой MISIS Leaf Lovers